YUI.add("moodle-atto_embedquestion-button",function(e,t){var n="atto_embedquestion",r="atto-embedquestion-question-selector-wrapper",i="atto-embedquestion-submit-button";e.namespace("M.atto_embedquestion").Button=e.Base.create("button",e.M.editor_atto.EditorPlugin,[],{currentSelection:null,doneOnce:!1,qForm:!1,initializer:function(){var t,r;if(!this.get("enablebutton"))return;t=this.get("contextid"),r=this.get("elementid"),this.addButton({icon:"icon",iconComponent:n,callback:this.displayDialogue}),e.M.atto_embedquestion.form={},require(["atto_embedquestion/qform"],function(n){n.setContextId(t),e.M.atto_embedquestion.form[r]=n,e.M.atto_embedquestion.dialogue=!1})},displayDialogue:function(){var t,s,o,u;this.currentSelection=this.get("host").getSelection(),t=M.util.image_url("y/loading"),s='<div class="'+r+'">'+'<img class="icon " src="'+t+'" alt="Loading..." title="Loading...">'+"</div>"+'<button class="'+i+'">'+M.util.get_string("embedqcode",n)+"</button>",e.M.atto_embedquestion.dialogue||(e.M.atto_embedquestion.dialogue=this.getDialogue({headerContent:M.util.get_string("pluginname",n),focusAfterHide:!0,bodyContent:s},!0)),e.M.atto_embedquestion.dialogue.show(),u=this.get("elementid"),this.doneOnce||(this.qForm=e.M.atto_embedquestion.form[u],this.qForm.setRootNode("."+r)),this.qForm.insertQform(),this.doneOnce||(o=e.all("."+i),o.on("click",this.insertQcode,this),this.doneOnce=!0)},insertQcode:function(e){var t,n;this.getDialogue({focusAfterHide:null}).hide(),t=this.get("host"),t.setSelection(this.currentSelection),t.insertContentAtFocusPoint(e),this.markUpdated()}},{ATTRS:{enablebutton:{value:!1},contextid:{value:!1},elementid:{value:!1}}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});
