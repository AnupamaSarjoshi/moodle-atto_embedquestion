YUI.add("moodle-atto_embedquestion-button",function(e,t){var n="atto_embedquestion",r="atto-embedquestion-question-selector-wrapper",i="atto-embedquestion-submit-button";e.namespace("M.atto_embedquestion").Button=e.Base.create("button",e.M.editor_atto.EditorPlugin,[],{currentSelection:null,doneOnce:!1,qForm:!1,initializer:function(){var t,r;if(!this.get("enablebutton"))return;t=this.get("contextid"),r=this.get("elementid"),this.addButton({icon:"icon",iconComponent:n,callback:this.displayDialogue}),e.M.atto_embedquestion.form={},require(["atto_embedquestion/qform"],function(n){n.setContextId(t),e.M.atto_embedquestion.form[r]=n})},displayDialogue:function(){var t,s,o,u,a;this.currentSelection=this.get("host").getSelection(),t=M.util.image_url("y/loading"),o='<div class="'+r+'">'+'<img class="icon " src="'+t+'" alt="Loading..." title="Loading...">'+"</div>"+'<button class="'+i+'">'+M.util.get_string("embedqcode",n)+"</button>",s=this.getDialogue({headerContent:M.util.get_string("pluginname",n),focusAfterHide:!0,bodyContent:o},!0),s.show(),a=this.get("elementid"),this.doneOnce||(this.qForm=e.M.atto_embedquestion.form[a],this.qForm.setRootNode("."+r)),this.qForm.insertQform(),this.doneOnce||(u=e.all("."+i),u.on("click",this.insertQcode,this),this.doneOnce=!0)},insertQcode:function(){var t,n,i,s;s=this.getDialogue().get("id"),this.getDialogue({focusAfterHide:null}).hide(),t=this.qForm.getQformData(),e.one("#"+s+" div."+r+" form").remove(!0),n="{Q{"+t.catidnum+"/"+t.queidnum+"|0123456..."+"}Q}",i=this.get("host"),i.setSelection(this.currentSelection),i.insertContentAtFocusPoint(n),this.markUpdated()}},{ATTRS:{enablebutton:{value:!1},contextid:{value:!1},elementid:{value:!1}}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});
